## üõ°Ô∏è x-mask: –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ –û–°/—Å–µ—Ä–≤–µ—Ä–∞

`x-mask` ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–º–µ–Ω–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã, —á—Ç–æ–±—ã —Å–±–∏—Ç—å —Å —Ç–æ–ª–∫—É —Å–∫–∞–Ω–µ—Ä—ã –∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç —Å–∫—Ä—ã—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –û–°, —Å–µ—Ç–µ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ç–∏–ø —Å–µ—Ä–≤–∏—Å–æ–≤.

---

### üîß –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `x-mask`                                                       |
|------------------|------------------------------------------------------------------------------|
| **TTL**           | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `net.ipv4.ip_default_ttl` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–æ—Ñ–∏–ª—é |
| **TCP Window**    | –î–æ–±–∞–≤–ª—è–µ—Ç iptables-–ø—Ä–∞–≤–∏–ª–æ, –∏–∑–º–µ–Ω—è—é—â–µ–µ TCP MSS (–º–∞—Å–∫–∞ –æ–∫–Ω–∞ TCP)              |
| **SSH –±–∞–Ω–Ω–µ—Ä**    | –ú–µ–Ω—è–µ—Ç SSH –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ `/etc/ssh_banner`                              |
| **HTTP Server**   | –î–æ–±–∞–≤–ª—è–µ—Ç —Ñ–µ–π–∫–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Server: ...` –≤ –∫–æ–Ω—Ñ–∏–≥ Apache                   |

---

### ‚öôÔ∏è –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

| –ü—Ä–æ—Ñ–∏–ª—å   | TTL | TCP Window | SSH-Banner                        | HTTP Server        |
|-----------|-----|------------|-----------------------------------|---------------------|
| `win11`   | 128 | 65535      | SSH-2.0-OpenSSH_7.9 Win32         | IIS/10.0            |
| `debian`  | 64  | 29200      | SSH-2.0-OpenSSH_8.3p1 Debian      | Apache/2.4.41 (Debian) |

> –¢—ã –º–æ–∂–µ—à—å –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –ø—Ä–æ—Ñ–∏–ª–∏ –≤ `fingerprint_hider.py`

---

### üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∞—Å–∫—É:
```bash
sudo sysfox x-mask --profile win11
```

#### üîÑ –û—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –≤–µ—Ä–Ω—É—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ –¥–µ—Ñ–æ–ª—Ç:
```bash
sudo sysfox x-mask --revert
```

---

### üìÇ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `--revert`

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç     | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫                |
|----------------|-------------------------------|
| TTL            | 64 (–¥–µ—Ñ–æ–ª—Ç –¥–ª—è Linux)         |
| iptables       | –û—á–∏—â–∞–µ—Ç `mangle` —Ç–∞–±–ª–∏—Ü—É      |
| SSH –±–∞–Ω–Ω–µ—Ä     | –£–¥–∞–ª—è–µ—Ç—Å—è `Banner`, —Ñ–∞–π–ª, —Ä–µ—Å—Ç–∞—Ä—Ç SSH |
| Apache –∑–∞–≥–æ–ª–æ–≤–∫–∏ | –£–¥–∞–ª—è—é—Ç—Å—è `ServerTokens`, `Header`, —Ä–µ—Å—Ç–∞—Ä—Ç Apache |

---

### üõ†Ô∏è –†–µ–∑–µ—Ä–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
–ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∞—Å–∫–∏:
```bash
sudo iptables-save > ~/iptables.bak
sudo cp /etc/ssh/sshd_config ~/sshd_config.bak
sudo cp /etc/apache2/conf-enabled/security.conf ~/apache_conf.bak
```

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
sudo iptables-restore < ~/iptables.bak
sudo cp ~/sshd_config.bak /etc/ssh/sshd_config && sudo systemctl restart ssh
sudo cp ~/apache_conf.bak /etc/apache2/conf-enabled/security.conf && sudo systemctl restart apache2
```

---

### üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –¢—Ä–µ–±—É–µ—Ç `sudo`
- –õ—É—á—à–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤, honeypots, CTF –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–π

---

‚úÖ `x-mask` ‚Äî –º–æ—â–Ω—ã–π –∏ —Å–∫—Ä—ã—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –ù–æ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Ç–æ–≥–æ, **—á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å**.

